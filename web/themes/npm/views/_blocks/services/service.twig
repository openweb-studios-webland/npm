{% set uid = random() %}

<div class="bg-white h-full relative shadow-sm">
  {% set image = TimberImage(service.image) %}

  {% if image.src %}
    <img src="{{ image.src | resize(450, 450, 'center') }}" alt="{{ image.alt }}" />
  {% endif %}

  <div class="p-20">
    {% if service.heading %}
      <h3 class="heading-4 mb-15">
        {{ service.heading }}
      </h3>
    {% endif %}

    {% if service.text %}
      <div class="text text-14">
        {{ service.text | length > 120 ? service.text | excerpt(120) ~ '...' : service.text }}
      </div>
    {% endif %}

    <button
      class="font-bold inline-block mt-20 text-14 text-blue-link"
      data-module="toggle"
      data-toggle-partner="{{ uid }}{{ loop.index }}0"
      aria-controls="{{ uid }}{{ loop.index }}"
    >
      See Details
    </button>
  </div>

  <div
    id="{{ uid }}{{ loop.index }}"
    class="absolute bg-white inset-x-0 min-h-full px-30 py-40 shadow-sm top-0"
    aria-hidden="true"
  >
    <h3 class="heading-4 mb-20">
      {{ service.title }}
    </h3>

    {% if service.text %}
      <div class="text mb-20 text-14">
        {{ service.text }}
      </div>
    {% endif %}

    {% if service.platforms | length %}
      <h4 class="mb-5 text-11 text-gray-a11y">
        Available on
      </h4>

      <p class="font-bold mb-20 text-14">
        {% for platform in Term(service.platforms)  %}
          {{ loop.last ? platform.name : platform.name ~ ', ' }}
        {% endfor %}
      </p>
    {% endif %}

    {% if service.products | length %}
      <h4 class="mb-5 text-11 text-gray-a11y">
        Related Products
      </h4>

      <p class="font-bold mb-20 text-14">
        {% for product in Post(service.products) %}
            {{ loop.last ? '<a class="text-blue-link" href="' ~ product.link ~ '">' ~ product.title ~ '</a>' : '<a class="text-blue-link" href="' ~ product.link ~ '">' ~ product.title ~ '</a>, ' }}
          </a>
        {% endfor %}
      </p>
    {% endif %}

    {% if service.work | length %}
      <h4 class="mb-5 text-11 text-gray-a11y">
        Related Work
      </h4>

      <p class="font-bold mb-20 text-14">
        {% for work in Post(service.work) %}
          {{ loop.last ? '<a class="text-blue-link" href="' ~ work.link ~ '">' ~ work.title ~ '</a>' : '<a class="text-blue-link" href="' ~ work.link ~ '">' ~ work.title ~ '</a>, ' }}
        {% endfor %}
      </p>
    {% endif %}

    {% if service.button_link and service.button_text %}
      <a class="button w-full" href="{{ service.button_link }}">
        {{ service.button_text }}
      </a>
    {% endif %}

     <button
      id="{{ uid }}{{ loop.index }}0"
      class="absolute h-44 mr-5 mt-5 right-0 top-0 w-44"
      aria-controls="{{ uid }}"
    >
      <span class="sr-only">
        Close
      </span>
      {{ svg('close', { classes: 'absolute inset-1/2 pointer-events-none translate-1/2' }) }}
    </button>
  </div>
</div>
