{% set block = block ?? null %}

{% if block %}
  <section class="section" data-label="work-groups">
    <div class="container -mb-100">
      {% if block.work_groups | length %}
        {% for work_group in block.work_groups %}
          {% if work_group.heading %}
            <h2 class="heading-4 text-center">
              {{ work_group.heading }}
            </h2>
          {% endif %}

          {% if work_group.work | length %}
            <div class="flex flex-wrap mb-50 -mx-30">
              {% for work in work_group.work %}
                <div class="mb-50 px-30 w-full md:w-1/2 lg:w-1/3">
                  {% set uid = random() %}

                  {% if work.type == 'audio' %}
                    <div class="border border-gray-border">
                      {% include '_partials/audio.twig' ignore missing with {
                        audio: work.audio,
                      } only %}
                    </div>

                    <div class="flex mt-20 -mx-5">
                      <div class="px-5">
                        {% set thumbnail_image = TimberImage(work.thumbnail_image) %}

                        {% if thumbnail_image.src %}
                          <img src="{{ thumbnail_image.src | resize(150, 150, 'center') }}" alt="{{ thumbnail_image.alt }}" />
                        {% endif %}
                      </div>

                      <div class="px-5">
                        {% if work.text %}
                          <p class="text text-14">
                            {{ work.text }}
                          </p>
                        {% endif %}
                      </div>
                    </div>
                  {% elseif work.type == 'video' %}
                    <div class="relative" data-modal-open="{{ uid }}">
                      {% set image = TimberImage(work.image) %}

                      {% if image.src %}
                        <img src="{{ image.src | resize(720, 405, 'center') }}" alt="{{ image.alt }}" />

                        <button class="absolute inset-1/2 h-80 translate-1/2 w-80">
                          <span class="screen-reader-only">
                            Open
                          </span>
                          {{ svg('play') }}
                        </button>
                      {% endif %}
                    </div>

                    {% if work.text %}
                      <div class="mt-20">
                        <p class="text text-14">
                          {{ work.text }}
                        </p>
                      </div>
                    {% endif %}

                    <div
                      id="{{ uid }}"
                      class="modal bg-black-semi-opaque fixed inset-0 py-20 z-50"
                      aria-hidden="true"
                      data-module="modal"
                    >
                      <div class="flex flex-col h-full justify-center" tabindex="-1" data-modal-close>
                        <div class="container-md w-full">
                          <div
                            class="bg-white max-h-screen overflow-y-auto p-50 relative"
                            role="dialog"
                            aria-modal="true"
                          >
                            <div class="video">
                              {{ work.video }}
                            </div>

                            <button class="absolute h-44 right-0 top-0 w-44" aria-label="Close modal" data-modal-close>
                              <span class="screen-reader-only">
                                Close
                              </span>
                              {{ svg('close', { classes: 'absolute inset-1/2 pointer-events-none translate-1/2' }) }}
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  {% else %}
                    {% set image = TimberImage(work.image) %}

                    {% if image.src %}
                      <div data-modal-open="{{ uid }}">
                        <img src="{{ image.src | resize(720, 405, 'center') }}" alt="{{ image.alt }}" />
                      </div>
                    {% endif %}

                    {% if work.text %}
                      <div class="mt-20">
                        <p class="text text-14">
                          {{ work.text }}
                        </p>
                      </div>
                    {% endif %}

                    <div
                      id="{{ uid }}"
                      class="modal bg-black-semi-opaque fixed inset-0 py-20 z-50"
                      aria-hidden="true"
                      data-module="modal"
                    >
                      <div class="flex flex-col h-full justify-center" tabindex="-1" data-modal-close>
                        <div class="container-lg w-full">
                          <div
                            class="bg-white max-h-screen overflow-y-auto p-50 relative"
                            role="dialog"
                            aria-modal="true"
                          >
                            <div class="container-md">
                              {% if work.images | length %}
                                <div
                                  class="carousel overflow-x-hidden"
                                  data-module="carousel"
                                  data-carousel-loop="false"
                                >
                                  <div class="carousel-track flex items-center relative -mx-10" data-carousel-track>
                                    {% for image in work.images %}
                                      <div class="flex-0 px-10 w-full">
                                        {% set image = TimberImage(image) %}

                                        {% if image.src %}
                                          <img src="{{ image.src | resize(1920, null, 'center') }}" alt="{{ image.alt }}" />
                                        {% endif %}

                                        {% if image.caption %}
                                          <p class="mt-20 text text-14">
                                            {{ image.caption }}
                                          </p>
                                        {% endif %}
                                      </div>
                                    {% endfor %}
                                  </div>

                                  <div class="flex mt-30 -mx-5 text-blue">
                                    <div class="px-5">
                                      {% include '_partials/carousel/button-prev.twig' ignore missing %}
                                    </div>

                                    <div class="px-5">
                                      {% include '_partials/carousel/button-next.twig' ignore missing %}
                                    </div>
                                  </div>
                                </div>
                              {% endif %}
                            </div>

                            <button class="absolute h-44 right-0 top-0 w-44" aria-label="Close modal" data-modal-close>
                              <span class="screen-reader-only">
                                Close
                              </span>
                              {{ svg('close', { classes: 'absolute inset-1/2 pointer-events-none translate-1/2' }) }}
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  {% endif %}
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% endfor %}
      {% endif %}
    </div>
  </section>
{% endif %}
